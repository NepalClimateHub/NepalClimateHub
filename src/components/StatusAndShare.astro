---
interface Props {
    status: string;
}

const {status} = Astro.props;

const cleanedStatus = status.toLowerCase().trim();
const statusClass = status ? `status-${cleanedStatus}`: 'status-unknown' ;
---

<div class="container">
  <!-- event status -->
   {
     status && (<div class={`event-status ${statusClass}`}>{cleanedStatus}</div>)
   }
  <!-- Event share section -->
    <div class="event-share">
        <span class="share-label">Share:</span>
        <div class="icon-wrapper">
          <div class="copy-container">
            <!-- Copy link button -->
            <button class="copy-btn">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M3.87868 3.87868C4.44129 3.31607 5.20435 3 6 3H14C14.7956 3 15.5587 3.31607 16.1213 3.87868C16.6839 4.44129 17 5.20435 17 6V7H18C19.6569 7 21 8.34315 21 10V18C21 19.6569 19.6569 21 18 21H10C8.34315 21 7 19.6569 7 18V17H6C5.20435 17 4.44129 16.6839 3.87868 16.1213C3.31607 15.5587 3 14.7956 3 14V6C3 5.20435 3.31607 4.44129 3.87868 3.87868ZM9 18C9 18.5523 9.44772 19 10 19H18C18.5523 19 19 18.5523 19 18V10C19 9.44772 18.5523 9 18 9H10C9.44772 9 9 9.44772 9 10V18ZM15 7H10C8.34315 7 7 8.34315 7 10V15H6C5.73478 15 5.48043 14.8946 5.29289 14.7071C5.10536 14.5196 5 14.2652 5 14V6C5 5.73478 5.10536 5.48043 5.29289 5.29289C5.48043 5.10536 5.73478 5 6 5H14C14.2652 5 14.5196 5.10536 14.7071 5.29289C14.8946 5.48043 15 5.73478 15 6V7Z" />
              </svg>
            </button>
            <div class="copied-toast">Link copied</div>
            <div class="not-copied-toast">Failed to copy</div>
          </div>
          <!-- share to social media buttons -->
          <a
            href="#"
            class="icon"
            aria-label="LinkedIn profile"
            target="_blank"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="icon icon-tabler icons-tabler-outline icon-tabler-brand-linkedin"
              ><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path
                d="M8 11v5"></path><path d="M8 8v.01"></path><path d="M12 16v-5"
              ></path><path d="M16 16v-3a2 2 0 1 0 -4 0"></path><path
                d="M3 7a4 4 0 0 1 4 -4h10a4 4 0 0 1 4 4v10a4 4 0 0 1 -4 4h-10a4 4 0 0 1 -4 -4z"
              ></path></svg
            >
          </a>
          <a
            href="#"
            class="icon"
            aria-label="Instagram profile"
            target="_blank"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="icon icon-tabler icons-tabler-outline icon-tabler-brand-instagram"
              ><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path
                d="M4 8a4 4 0 0 1 4 -4h8a4 4 0 0 1 4 4v8a4 4 0 0 1 -4 4h-8a4 4 0 0 1 -4 -4z"
              ></path><path d="M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0"></path><path
                d="M16.5 7.5v.01"></path></svg
            >
          </a>
          <a
            href="#"
            class="icon"
            aria-label="Facebook profile"
            target="_blank"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="icon icon-tabler icons-tabler-outline icon-tabler-brand-facebook"
              ><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path
                d="M7 10v4h3v7h4v-7h3l1 -4h-4v-2a1 1 0 0 1 1 -1h3v-4h-3a5 5 0 0 0 -5 5v2h-3"
              ></path></svg
            >
          </a>
        </div>
    </div>
</div>

<script>
  const copyBtn = document.querySelector('.copy-btn') as HTMLElement;
  const copiedToast = document.querySelector('.copied-toast') as HTMLElement;
  const notCopiedToast = document.querySelector('.not-copied-toast') as HTMLElement;

  let shouldWait = false;

  copyBtn?.addEventListener('click', showToast);

  async function showToast() {
    if (shouldWait) return;
    shouldWait = true;
    try{
      await navigator.clipboard.writeText(window.location.href);
      copiedToast.style.display = 'block';
      setTimeout(function () {
        copiedToast.style.display = 'none';
        shouldWait = false;
    }, 3000);
    }catch(err){
        notCopiedToast.style.display = 'block';
        setTimeout(function () {
          notCopiedToast.style.display = 'none';
          shouldWait = false;
        }, 3000);
    }
  }
</script>

<style>
  .container{
    display: flex;
    gap: 10px;
    justify-content: space-between;
    margin-bottom: 8px;
    flex-wrap: wrap;
  }

  .event-status{
    border-radius: 16px;
    padding: 5px 12px;
    font-size: 12px;
    text-transform: capitalize;
  }
  .status-open{
    border: 1px solid #5BA300;
    background-color: #E8FFD1;
    color: #5BA300;
    font-weight: 400;
  }
  .status-ongoing{
    border: 1px solid #364FC7;
    background-color: #E8FFD1;
    color: #364FC7;
  }
  .status-closed{
    border: 1px solid #D92D20;
    background-color: #FFE5E5;
    color: #D92D20;
  }
  .status-upcoming, .status-unknown {
    border: 1px solid #CA8A04;
    background-color: #FEF3C7;
    color: #CA8A04;
  }

  .event-share{
    display: flex;
    gap: 8px;
    align-items: center;
    margin-left: auto;
  }
  .share-label{
    color: #1A1B1E;
    font-weight: 800;
  }

  .copy-container{
    position: relative;
  }
  .copy-btn{
    cursor: pointer;
    display: flex;
    align-items: center;
    border: none;
    background: none;
  }
  .copied-toast, .not-copied-toast{
    position: absolute;
    left: 0;
    bottom: 0;
    transform: translateY(110%);
    border-radius: 4px;
    color: #ffffff;
    font-size: 12px;
    background-color: #1A1B1E;
    /* border: 1px solid #cefe00; */
    text-align: center;
    padding: 6px 10px;
    white-space: nowrap;
    display: none;
  }
  .copy-btn svg{
    fill: #1A1B1E;
  }
  .copy-btn:hover svg{
    fill: #cefe00
  }
  .copy-btn:active svg, .icon:active svg{
    opacity: .3;
  }

  .icon-wrapper {
    display: flex;
    gap: 12px;
    align-items: center;
  }
  .icon{
    display: flex;
    align-items: center;
  }
  .icon svg {
    stroke: #1A1B1E;
  }
  .icon:hover svg {
    stroke: #cefe00;
  }
</style>