---
import { Icon } from 'astro-icon/components';
import '../styles/global.css';

// dataObj can either be organization data or activist data or event data; sent via props
const { dataObj, organization = 'true' } = Astro.props;

// Check if this is an event (has different structure than organizations/activists)
const isEvent = organization === 'false' && dataObj && 'title' in dataObj;

// initialize activeDataObject with a proper type
const activeDataObject = dataObj;

// Get the appropriate properties based on data type
const name = isEvent ? activeDataObject?.title : activeDataObject?.name;
const location = isEvent
  ? activeDataObject?.location
  : activeDataObject?.address;
const description = activeDataObject?.description || '';

// Handle tags/categories differently based on data type
const tags = isEvent
  ? activeDataObject?.category || []
  : activeDataObject?.tags || [];

// Handle pictures differently based on data type
const pictures = isEvent
  ? [activeDataObject?.bannerImage].filter(Boolean)
  : activeDataObject?.pictures || [];
---


<center>
 <center class="max-w-7xl mx-auto px-6 lg:px-6 md:px-0 bg-white rounded-3xl shadow-xl border border-gray-100 !mb-20 !flex !justify-center !mt-10">
   <!-- container for organization card -->
   <div class="my-9 mb-22 flex text-start gap-4 !p-20 ">
               <div class="w-1/2 border-b border-lime-400 pb-4 p-20 lg:w-full lg:p-8 md:w-full md:p-6 lg:border-b-0 md:border-b-0">
         <h2 class="text-3xl lg:text-2xl md:text-xl font-bold leading-10 mb-6">
           {name}
         </h2>
         <div class="text-sm leading-4 text-blue-600 mb-3 flex items-center gap-1">
           <span class="icon">
             <Icon name="mdi:my-location" class="icon" />
           </span>
           {location}
         </div>
         
                   <!-- HTML rendering with JavaScript override -->
          <div class="!mb-9" id="description-content" set:html={description} />
          
          <script>
            // Force list styling after the page loads
            document.addEventListener('DOMContentLoaded', function() {
              const descriptionContent = document.getElementById('description-content');
              if (descriptionContent) {
                // Remove default list styling to prevent double bullets
                const lists = descriptionContent.querySelectorAll('ul');
                lists.forEach(ul => {
                  ul.style.setProperty('list-style', 'none', 'important');
                  ul.style.setProperty('padding-left', '1.5rem', 'important');
                  ul.style.setProperty('margin-bottom', '1rem', 'important');
                });
                
                const listItems = descriptionContent.querySelectorAll('li');
                listItems.forEach(li => {
                  li.style.setProperty('list-style', 'none', 'important');
                  li.style.setProperty('display', 'list-item', 'important');
                  li.style.setProperty('margin-bottom', '0.5rem', 'important');
                });
                
                // Add custom bullet points using ::before
                const style = document.createElement('style');
                style.textContent = `
                  #description-content ul li {
                    position: relative !important;
                    padding-left: 0 !important;
                  }
                  
                  #description-content ul li::before {
                    content: "â€¢ " !important;
                    color: #000 !important;
                    font-weight: bold !important;
                    position: absolute !important;
                    left: -1rem !important;
                    top: 0 !important;
                    display: inline-block !important;
                  }
                `;
                document.head.appendChild(style);
              }
            });
          </script>
          
        

                   <!-- tags for organizations / activists causes -->
          <div class="flex flex-wrap gap-3 mb-6">
            {tags.map((tag: string) => (
              <span class="inline-flex items-center px-4 py-2 !p-2 text-sm font-medium bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-700 border border-blue-200 rounded-full shadow-sm hover:shadow-md transition-all duration-300 hover:scale-105 hover:bg-gradient-to-r hover:from-blue-100 hover:to-indigo-100 hover:border-blue-300 cursor-pointer">
                {tag}
              </span>
            ))}
          </div>

         {
           isEvent && activeDataObject?.registrationLink && (
             <div class="mt-5">
               <a
                 href={activeDataObject.registrationLink}
                 target="_blank"
                 rel="noopener noreferrer"
                 class="inline-block bg-lime-400 text-gray-900 font-semibold px-5 py-2.5 rounded-lg text-decoration-none transition-colors duration-300 hover:bg-lime-500"
               >
                 Register Now
               </a>
               {activeDataObject?.registrationDeadline && (
                 <p class="text-sm text-gray-600 mt-2">
                   Registration Deadline:{" "}
                   {new Date(
                     activeDataObject.registrationDeadline
                   ).toLocaleDateString("en-US", {
                     year: "numeric",
                     month: "long",
                     day: "numeric",
                   })}
                 </p>
               )}
             </div>
           )
         }
       </div>

       <!-- image container section -->
       <div class="w-1/2 flex items-center lg:w-1/2 md:w-full">
         {
           pictures.length == 1 ? (
             // if length == 1, then apply single-image-wrapper class
             <div class="w-full h-auto rounded-2xl ml-auto float-right">
               <img src={pictures[0] || "/placeholder.svg"} alt="" class="w-full h-auto object-contain rounded-2xl" />
             </div>
           ) : (
             pictures.map((pictureURL: string) => (
               <div class="w-full h-auto rounded-2xl">
                 <img src={pictureURL || "/placeholder.svg"} alt="" class="w-full h-auto object-contain rounded-2xl" />
               </div>
             ))
           )
         }
       </div>
     </div>
   </div>
   </center>
</center>




